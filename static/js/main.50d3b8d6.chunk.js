(this["webpackJsonpwebrtc-react"]=this["webpackJsonpwebrtc-react"]||[]).push([[0],{104:function(e,t,n){e.exports=n(217)},109:function(e,t,n){},110:function(e,t,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},111:function(e,t,n){},113:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=113},119:function(e,t){},121:function(e,t){},132:function(e,t){},134:function(e,t){},161:function(e,t){},163:function(e,t){},164:function(e,t){},170:function(e,t){},172:function(e,t){},190:function(e,t){},193:function(e,t){},209:function(e,t){},212:function(e,t){},217:function(e,t,n){"use strict";n.r(t);var a,o,i=n(2),r=n.n(i),c=n(97),s=n.n(c),u=(n(109),n(110),n(111),n(9)),l=n.n(u),d=n(19),h=n(98),p=n(99),f=n(8),v=n(103),m=n(102),g=n(100),b=n.n(g),O=n(101),k=n.n(O),E=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(h.a)(this,n),(a=t.call(this,e)).state={peer:"",peerToConnect:"",connected:!1,message:"",connection:null,webCamON:!1,videoOn:!0,audioOn:!1,peerServerPath:"",port:""},a.handleClick=a.handleClick.bind(Object(f.a)(a)),a.updateUserPeerId=a.updateUserPeerId.bind(Object(f.a)(a)),a.updateMessage=a.updateMessage.bind(Object(f.a)(a)),a.sendMessage=a.sendMessage.bind(Object(f.a)(a)),a.handleVideoToggle=a.handleVideoToggle.bind(Object(f.a)(a)),a.handleAudioToggle=a.handleAudioToggle.bind(Object(f.a)(a)),a.initPeerConnection=a.initPeerConnection.bind(Object(f.a)(a)),a.updatePeerServerPath=a.updatePeerServerPath.bind(Object(f.a)(a)),a.updatePort=a.updatePort.bind(Object(f.a)(a)),a}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var e=window.location.href;console.log(e)}},{key:"initPeerConnection",value:function(){var e=Object(d.a)(l.a.mark((function e(){var t,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(t=new b.a(k.a.generate(),{host:this.state.peerServerPath,port:this.state.port,path:"/"})).on("connection",(function(e){n.setState({connection:e}),e.on("data",(function(t){n.setState({connection:e}),console.log(t),n.setState({connected:!0})})),e.on("open",(function(){n.setState({connection:e}),e.send("hello!"),n.setState({connected:!0})}))})),t.on("call",(function(e){n.setState({connected:!0}),e.answer(o),e.on("stream",(function(e){n.remoteVideo.srcObject=e}))})),t.on("error",(function(e){console.log(e),n.setState({connected:!1})})),e.next=6,this.setState({peer:t});case 6:this.initLocalVideo();case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updatePeerServerPath",value:function(e){this.setState({peerServerPath:e.target.value})}},{key:"updatePort",value:function(e){this.setState({port:e.target.value})}},{key:"initLocalVideo",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.videoOn&&!this.state.audioOn){e.next=9;break}return e.next=3,navigator.mediaDevices.getUserMedia({video:this.state.videoOn,audio:!1});case 3:return a=e.sent,e.next=6,navigator.mediaDevices.getUserMedia({video:this.state.videoOn,audio:this.state.audioOn});case 6:o=e.sent,e.next=11;break;case 9:o=null,a=null;case 11:this.localVideo.srcObject=a,this.setState({webCamON:!0});case 13:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleVideoToggle",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({videoOn:!this.state.videoOn});case 2:this.initLocalVideo();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"handleAudioToggle",value:function(){var e=Object(d.a)(l.a.mark((function e(){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.setState({audioOn:!this.state.audioOn});case 2:this.initLocalVideo();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"updateUserPeerId",value:function(e){this.setState({peerToConnect:e.target.value})}},{key:"updateMessage",value:function(e){this.setState({message:e.target.value})}},{key:"sendMessage",value:function(){this.state.connected&&this.state.connection.send(this.state.message)}},{key:"handleClick",value:function(){var e=this,t=this.state.peer,n=t.connect(this.state.peerToConnect);n.on("open",(function(){e.setState({connection:n}),n.send("hi!"),e.setState({connected:!0})})),n.on("data",(function(t){e.setState({connection:n}),console.log(t),e.setState({connected:!0})})),t.call(this.state.peerToConnect,o).on("stream",function(){var t=Object(d.a)(l.a.mark((function t(n){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.setState({connected:!0});case 2:e.remoteVideo.srcObject=n;case 3:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,this.state.peer?r.a.createElement("div",null,r.a.createElement("h1",null,"Hello, ",this.state.peer._id),r.a.createElement("div",null,"Enter Peer id to connect: ",r.a.createElement("input",{type:"text",value:this.state.peerToConnect,onChange:this.updateUserPeerId,name:"peerToConnect"}),r.a.createElement("button",{onClick:this.handleClick},"Connect")),r.a.createElement("br",null),r.a.createElement("br",null),this.state.connected?r.a.createElement("div",null,"Enter Message to send:",r.a.createElement("input",{type:"text",value:this.state.message,onChange:this.updateMessage,name:"message"}),r.a.createElement("button",{onClick:this.sendMessage},"Send")):"",r.a.createElement("video",{ref:function(t){e.localVideo=t},id:"localVideo",autoPlay:!0,src:a}),r.a.createElement("br",null),r.a.createElement("div",null,r.a.createElement("button",{onClick:this.handleVideoToggle},"Video ",this.state.videoOn?" Off":" On"),r.a.createElement("button",{onClick:this.handleAudioToggle},"Audio ",this.state.audioOn?" Off":" On")),this.state.connected?r.a.createElement("video",{id:"remoteVideo",ref:function(t){e.remoteVideo=t},autoPlay:!0,muted:!0}):""):r.a.createElement("div",null,"Enter Peer Server path: ",r.a.createElement("input",{type:"text",value:this.state.peerServerPath,onChange:this.updatePeerServerPath,name:"peerServerPath"}),r.a.createElement("br",null),"Enter Peer Port number:",r.a.createElement("input",{type:"text",value:this.state.port,onChange:this.updatePort,name:"port"}),r.a.createElement("br",null),r.a.createElement("button",{onClick:this.initPeerConnection},"Connect")))}}]),n}(i.Component);var S=function(){return r.a.createElement(E,{name:"uk"})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(S,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[104,1,2]]]);
//# sourceMappingURL=main.50d3b8d6.chunk.js.map